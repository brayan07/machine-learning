Completed batch 125
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 126
Completed batch 127
Completed batch 128
Completed batch 129
Completed batch 130
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 131
Completed batch 132
Completed batch 133
Completed batch 134
Completed batch 135
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 136
Completed batch 137
Completed batch 138
Completed batch 139
Completed batch 140
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 141
Completed batch 142
Completed batch 143
Completed batch 144
Completed batch 145
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 146
Completed batch 147
Completed batch 148
Completed batch 149
Completed batch 150
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 151
Completed batch 152
Completed batch 153
Completed batch 154
Completed batch 155
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 156
Completed batch 157
Completed batch 158
Completed batch 159
Completed batch 160
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 161
Completed batch 162
Completed batch 163
Completed batch 164
Completed batch 165
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 166
Completed batch 167
Completed batch 168
Completed batch 169
Completed batch 170
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 171
Completed batch 172
Completed batch 173
Completed batch 174
Completed batch 175
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 176
Completed batch 177
Completed batch 178
Completed batch 179
Completed batch 180
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 181
Completed batch 182
Completed batch 183
Completed batch 184
Completed batch 185
Retrieving data..
Something went wrong. Skipping 1eedc349bd89c6eb14f1ff73f5821e27
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 186
Completed batch 187
Completed batch 188
Completed batch 189
Completed batch 190
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 191
Completed batch 192
Completed batch 193
Completed batch 194
Completed batch 195
Retrieving data..
Something went wrong. Skipping 09a8fdd43905244c6626e15385c9ae22
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 196
Completed batch 197
Completed batch 198
Completed batch 199
Completed batch 200
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 201
Completed batch 202
Completed batch 203
Completed batch 204
Completed batch 205
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 206
Completed batch 207
Completed batch 208
Completed batch 209
Completed batch 210
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 211
Completed batch 212
Completed batch 213
Completed batch 214
Completed batch 215
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 216
Completed batch 217
Completed batch 218
Completed batch 219
Completed batch 220
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 221
Completed batch 222
Completed batch 223
Completed batch 224
Completed batch 225
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 226
Completed batch 227
Completed batch 228
Completed batch 229
Completed batch 230
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 231
Completed batch 232
Completed batch 233
Completed batch 234
Completed batch 235
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 236
Completed batch 237
Completed batch 238
Completed batch 239
Completed batch 240
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 241
Completed batch 242
Completed batch 243
Completed batch 244
Completed batch 245
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 246
Completed batch 247
Completed batch 248
Completed batch 249
Completed batch 250
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 251
Completed batch 252
Completed batch 253
Completed batch 254
Completed batch 255
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 256
Completed batch 257
Completed batch 258
Completed batch 259
Completed batch 260
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 261
Completed batch 262
Completed batch 263
Completed batch 264
Completed batch 265
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 266
Completed batch 267
Completed batch 268
Completed batch 269
Completed batch 270
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 271
Completed batch 272
Completed batch 273
Completed batch 274
Completed batch 275
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 276
Completed batch 277
Completed batch 278
Completed batch 279
Completed batch 280
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 281
Completed batch 282
Completed batch 283
Completed batch 284
Completed batch 285
Retrieving data..
Something went wrong. Skipping c5fbd6ce1f6b25fc39e67ad66b215ab1
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 286
Completed batch 287
Completed batch 288
Completed batch 289
Completed batch 290
Retrieving data..
Something went wrong. Skipping 04b32b70b4ab15cad85d43e3b5359239
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 291
Completed batch 292
Completed batch 293
Completed batch 294
Completed batch 295
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 296
Completed batch 297
Completed batch 298
Completed batch 299
Completed batch 300
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 301
Completed batch 302
Completed batch 303
Completed batch 304
Completed batch 305
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 306
Completed batch 307
Completed batch 308
Completed batch 309
Completed batch 310
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 311
Completed batch 312
Completed batch 313
Completed batch 314
Completed batch 315
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 316
Completed batch 317
Completed batch 318
Completed batch 319
Completed batch 320
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 321
Completed batch 322
Completed batch 323
Completed batch 324
Completed batch 325
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 326
Completed batch 327
Completed batch 328
Completed batch 329
Completed batch 330
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 331
Completed batch 332
Completed batch 333
Completed batch 334
Completed batch 335
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 336
Completed batch 337
Completed batch 338
Completed batch 339
Completed batch 340
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 341
Completed batch 342
Completed batch 343
Completed batch 344
Completed batch 345
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 346
Completed batch 347
Completed batch 348
Completed batch 349
Completed batch 350
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 351
Completed batch 352
Completed batch 353
Completed batch 354
Completed batch 355
Retrieving data..
Something went wrong. Skipping e4e72e96bffb21e55381667911281616
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 356
Completed batch 357
Completed batch 358
Completed batch 359
Completed batch 360
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 361
Completed batch 362
Completed batch 363
Completed batch 364
Completed batch 365
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 366
Completed batch 367
Completed batch 368
Completed batch 369
Completed batch 370
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 371
Completed batch 372
Completed batch 373
Completed batch 374
Completed batch 375
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 376
Completed batch 377
Completed batch 378
Completed batch 379
Completed batch 380
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 381
Completed batch 382
Completed batch 383
Completed batch 384
Completed batch 385
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 386
Completed batch 387
Completed batch 388
Completed batch 389
Completed batch 390
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 391
Completed batch 392
Completed batch 393
Completed batch 394
Completed batch 395
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 396
Completed batch 397
Completed batch 398
Completed batch 399
Completed batch 400
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 401
Completed batch 402
Completed batch 403
Completed batch 404
Completed batch 405
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 406
Completed batch 407
Completed batch 408
Completed batch 409
Completed batch 410
Retrieving data..
Something went wrong. Skipping 906c2087a7215fbe7bd3f44adbf813a0
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 411
Completed batch 412
Completed batch 413
Completed batch 414
Completed batch 415
Retrieving data..
Something went wrong. Skipping c3ec4ac510d9f567519f74ab5700d0d3
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 416
Completed batch 417
Completed batch 418
Completed batch 419
Completed batch 420
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 421
Completed batch 422
Completed batch 423
Completed batch 424
Completed batch 425
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 426
Completed batch 427
Completed batch 428
Completed batch 429
Completed batch 430
Retrieving data..
Something went wrong. Skipping 68f1fbc65b8a12bcae61b077c67dff40
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 431
Completed batch 432
Completed batch 433
Completed batch 434
Completed batch 435
Retrieving data..
Something went wrong. Skipping 1beb3744a2da2da340ef7b7f2b793e32
Something went wrong. Skipping ed6433fbbe878e362b4cf03d85418456
Something went wrong. Skipping 48f1d872def62e5d5150c1a7d64d1196
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 436
Completed batch 437
Completed batch 438
Completed batch 439
Completed batch 440
Retrieving data..
Something went wrong. Skipping cd37891e5b1a753234d8e24dfdfbe650
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 441
Completed batch 442
Completed batch 443
Completed batch 444
Completed batch 445
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 446
Completed batch 447
Completed batch 448
Completed batch 449
Completed batch 450
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 451
Completed batch 452
Completed batch 453
Completed batch 454
Completed batch 455
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 456
Completed batch 457
Completed batch 458
Completed batch 459
Completed batch 460
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 461
Completed batch 462
Completed batch 463
Completed batch 464
Completed batch 465
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 466
Completed batch 467
Completed batch 468
Completed batch 469
Completed batch 470
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 471
Completed batch 472
Completed batch 473
Completed batch 474
Completed batch 475
Retrieving data..
Something went wrong. Skipping 9f1b80be911f6ec2f5617f9e37a0bbc3
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 476
Completed batch 477
Completed batch 478
Completed batch 479
Completed batch 480
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 481
Completed batch 482
Completed batch 483
Completed batch 484
Completed batch 485
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 486
Completed batch 487
Completed batch 488
Completed batch 489
Completed batch 490
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 491
Completed batch 492
Completed batch 493
Completed batch 494
Completed batch 495
Retrieving data..
Something went wrong. Skipping 4e51f4053cfd715825b39079558ac505
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 496
Completed batch 497
Completed batch 498
Completed batch 499
Completed batch 500
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 501
Completed batch 502
Completed batch 503
Completed batch 504
Completed batch 505
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 506
Completed batch 507
Completed batch 508
Completed batch 509
Completed batch 510
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 511
Completed batch 512
Completed batch 513
Completed batch 514
Completed batch 515
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 516
Completed batch 517
Completed batch 518
Completed batch 519
Completed batch 520
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 521
Completed batch 522
Completed batch 523
Completed batch 524
Completed batch 525
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 526
Completed batch 527
Completed batch 528
Completed batch 529
Completed batch 530
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 531
Completed batch 532
Completed batch 533
Completed batch 534
Completed batch 535
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 536
Completed batch 537
Completed batch 538
Completed batch 539
Completed batch 540
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 541
Completed batch 542
Completed batch 543
Completed batch 544
Completed batch 545
Retrieving data..
Something went wrong. Skipping 3a465a563e191135c396ba0fb608a844
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 546
Completed batch 547
Completed batch 548
Completed batch 549
Completed batch 550
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 551
Completed batch 552
Completed batch 553
Completed batch 554
Completed batch 555
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 556
Completed batch 557
Completed batch 558
Completed batch 559
Completed batch 560
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 561
Completed batch 562
Completed batch 563
Completed batch 564
Completed batch 565
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 566
Completed batch 567
Completed batch 568
Completed batch 569
Completed batch 570
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 571
Completed batch 572
Completed batch 573
Completed batch 574
Completed batch 575
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 576
Completed batch 577
Completed batch 578
Completed batch 579
Completed batch 580
Retrieving data..
Something went wrong. Skipping 82d9c305d2a2895c900f912f661a7464
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 581
Completed batch 582
Completed batch 583
Completed batch 584
Completed batch 585
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 586
Completed batch 587
Completed batch 588
Completed batch 589
Completed batch 590
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 591
Completed batch 592
Completed batch 593
Completed batch 594
Completed batch 595
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 596
Completed batch 597
Completed batch 598
Completed batch 599
Completed batch 600
Retrieving data..
Something went wrong. Skipping 255061b8296ef90d2a885e55cbf63c7a
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 601
Completed batch 602
Completed batch 603
Completed batch 604
Completed batch 605
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 606
Completed batch 607
Completed batch 608
Completed batch 609
Completed batch 610
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 611
Completed batch 612
Completed batch 613
Completed batch 614
Completed batch 615
Retrieving data..
Something went wrong. Skipping 3e74faa099d15364bfaf4e8b4f537178
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 616
Completed batch 617
Completed batch 618
Completed batch 619
Completed batch 620
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 621
Completed batch 622
Completed batch 623
Completed batch 624
Completed batch 625
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 626
Completed batch 627
Completed batch 628
Completed batch 629
Completed batch 630
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 631
Completed batch 632
Completed batch 633
Completed batch 634
Completed batch 635
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 636
Completed batch 637
Completed batch 638
Completed batch 639
Completed batch 640
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 641
Completed batch 642
Completed batch 643
Completed batch 644
Completed batch 645
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 646
Completed batch 647
Completed batch 648
Completed batch 649
Completed batch 650
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 651
Completed batch 652
Completed batch 653
Completed batch 654
Completed batch 655
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 656
Completed batch 657
Completed batch 658
Completed batch 659
Completed batch 660
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 661
Completed batch 662
Completed batch 663
Completed batch 664
Completed batch 665
Retrieving data..
Data retrieved
Initializing arrays...
Arrays initialized
Completed batch 1
^Completed batch 2
^C^CTraceback (most recent call last):
  File "CreateScanBatch.py", line 174, in <module>
    for X, y in trainGen.GenerateSamples():
  File "CreateScanBatch.py", line 79, in GenerateSamples
    X_train[i,j,:,:,chan] = hfuncs.CropCleanResize(X[i,:,:,j],FINAL_WIDTH,FINAL_HEIGHT)
  File "/home/ubuntu/machine-learning/projects/capstone/DHSThreatRecognition/HelperFuncs.py", line 141, in CropCleanResize
    min_i,max_i,max_j = FindCropDimensions(x)
  File "/home/ubuntu/machine-learning/projects/capstone/DHSThreatRecognition/HelperFuncs.py", line 55, in FindCropDimensions
    if x[i,j] > thresh:
KeyboardInterrupt
(DHSenv_3.5) ubuntu@ip-172-31-27-171:~/machine-learning/projects/capstone/DHSThreatRecognition$ vi CreateScanBatch.py  
[?1049h[?1h=[1;30r[34l[34h[?25h[23m[24m[0m[H[J[?25l[30;1H"CreateScanBatch.py" [noeol] 201L, 7148C[1;1H[35mimport[0m HelperFuncs [33mas[0m hfuncs
[35mimport[0m numpy [33mas[0m np
[35mfrom[0m sklearn.model_selection [35mimport[0m train_test_split
[35mfrom[0m keras.utils.data_utils [35mimport[0m Sequence
[35mimport[0m h5py
[35mimport[0m os
[35mimport[0m pickle
[35mimport[0m logging

logging.basicConfig(filename=[31m'UploadScans.log'[0m,level=logging.INFO)

BATCH_SIZE = [31m20[0m
FINAL_WIDTH = [31m400[0m
FINAL_HEIGHT = [31m600[0m
CHANNELS = [31m1[0m
ZONES = [31m17[0m
BUCKET_NAME = [31m'miscdatastorage'[0m
DATA_DIR = [31m'DHSData/'[0m
TEMP_DIR = [31m'temp'[0m
LABELS_DIR = [31mr'stage1_labels.csv'[0m
EXTENSION = [31m'.a3daps'[0m
np.random.seed([31m0[0m)

[34m#Define a generator function[0m
[33mclass[0m [36mmyScanGenerator[0m:
    [34m#AWS and Directory information [0m
    bucketName = BUCKET_NAME
    dataDir = DATA_DIR
    temp_dir = TEMP_DIR[30;100H1,1[11CTop[1;1H[34h[?25h[?25l[30;100H2[2;1H[34h[?25h[?25l[30;100H3[3;1H[34h[?25h[?25l[30;100H4[4;1H[34h[?25h[?25l[30;100H5[5;1H[34h[?25h[?25l[30;100H6[6;1H[34h[?25h[?25l[30;100H7[7;1H[34h[?25h[?25l[30;100H8[8;1H[34h[?25h[?25l[30;100H9,0-1[9;1H[34h[?25h[?25l[30;100H10,1 [10;1H[34h[?25h[?25l[30;101H1,0-1[11;1H[34h[?25h[?25l[30;101H2,1  [12;1H[34h[?25h[?25l[30;101H3[13;1H[34h[?25h[?25l[30;101H4[14;1H[34h[?25h[?25l[30;101H5[15;1H[34h[?25h[?25l[30;101H6[16;1H[34h[?25h[?25l[30;101H7[17;1H[34h[?25h[?25l[30;101H8[18;1H[34h[?25h[?25l[30;101H9[19;1H[34h[?25h[?25l[30;100H20[20;1H[34h[?25h[?25l[30;101H1[21;1H[34h[?25h[?25l[30;101H2[22;1H[34h[?25h[?25l[30;101H3,0-1[23;1H[34h[?25h[?25l[30;101H4,1  [24;1H[34h[?25h[?25l[30;101H5[25;1H[34h[?25h[?25l[30;101H6[26;1H[34h[?25h[?25l[30;101H7[27;1H[34h[?25h[?25l[30;101H8[28;1H[34h[?25h[?25l[30;101H9[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hlabels_dir = LABELS_DIR[30;1H[K[30;100H30,1[11C0%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#Connect to AWS[0m[30;100H[K[30;100H31,1[11C1%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey_id, secret_key = hfuncs.GetAWSCredentials()[30;100H[K[30;100H32,1[11C1%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hclient = hfuncs.GetAWSClient(key_id,secret_key)[30;100H[K[30;100H33,1[11C2%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hbucket = client.Bucket(bucketName)[30;100H[K[30;100H34,1[11C2%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hextension = EXTENSION[30;100H[K[30;100H35,1[11C3%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#labels and keys[0m[30;100H[K[30;100H36,1[11C4%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hlabels_dict = hfuncs.GetLabelsDict(labels_dir)[30;100H[K[30;100H37,1[11C4%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey_ary = [36mNone[0m[30;100H[K[30;100H38,1[11C5%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#Batch information[0m[30;100H[K[30;100H39,1[11C5%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hn_samples = [31m0[0m[30;100H[K[30;100H40,1[11C6%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hbatch_size = [31m0[0m[30;100H[K[30;100H41,1[11C6%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#Requester[0m[30;100H[K[30;100H42,1[11C7%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hbatch_requester = [36mNone[0m[30;100H[K[30;100H43,1[11C8%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#Initialize required parameters[0m[30;100H[K[30;100H44,1[11C8%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[33mdef[0m [36m__init__[0m(self,keys,n_samples):[30;100H[K[30;100H45,1[11C9%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[34m#Keys of samples to process[0m[30;100H[K[30;100H46,1[11C9%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9Hself.key_ary = keys[30;100H[K[30;100H47,1[10C10%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[34m#Samples to load at a time[0m[30;100H[K[30;100H48,1[10C11%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9Hself.n_samples = n_samples[30;100H[K[30;100H49,1[10C11%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[34m#Initialize AWS Batch Requester[0m[30;100H[K[30;100H50,1[10C12%[29;1H[34h[?25h[?25l[1;29r[1;1H[2M[1;30r[28;9Hself.batchrequester = hfuncs.BatchRequester(self.bucket,self.key_ary,self.labels_dict,self.dataDir,self.temp__[29;1Hdir,self.extension)[30;100H[K[30;100H51,1[10C13%[28;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[33mdef[0m [36mGenerateSamples[0m(self):[30;100H[K[30;100H52,1[10C13%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[31m'''Returns generator that retireves n_sample scans at a time,[0m[30;100H[K[30;100H53,1[10C14%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[31m        mixes each scan-slice image into a meta-batch, and returns mini-batches of [0m[30;100H[K[30;100H54,1[10C15%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[31m        BATCH_SIZE'''[0m[30;100H[K[30;100H55,1[10C15%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[34m#While there is data left, yield batch[0m[30;100H[K[30;100H56,1[10C16%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[33mwhile[0m self.batchrequester.DoItemsRemain():[30;100H[K[30;100H57,1[10C16%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[34m#Request data[0m[30;100H[K[30;100H58,1[10C17%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[36mprint[0m([31m"Retrieving data.."[0m)[30;100H[K[30;100H59,1[10C17%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hpointer = self.batchrequester.key_pointer[30;100H[K[30;100H60,1[10C18%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hlogging.info([31m"Last succesful key {} at pointer {}"[0m.format(self.batchrequester.keys[pointer],pointer))[30;100H[K[30;100H61,1[10C19%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13HX,y = self.batchrequester.NextBatch(self.n_samples)[30;100H[K[30;100H62,1[10C19%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hn_angles = X.shape[[31m3[0m] [34m#num angles (64)[0m[30;100H[K[30;100H63,1[10C20%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H64,0-1[8C20%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[36mprint[0m([31m"Data retrieved"[0m)[30;100H[K[30;100H65,1[10C21%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H66,0-1[8C21%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[34m#Initialize output arrays[0m[30;100H[K[30;100H67,1[10C22%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[36mprint[0m([31m"Initializing arrays..."[0m)[30;100H[K[30;100H68,1[10C23%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13HX_train = np.zeros((X.shape[[31m0[0m],n_angles,FINAL_WIDTH,FINAL_HEIGHT,CHANNELS))[30;100H[K[30;100H69,1[10C23%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hy_train = np.zeros((X.shape[[31m0[0m],ZONES))[30;100H[K[30;100H70,1[10C24%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[36mprint[0m([31m"Arrays initialized"[0m)[30;100H[K[30;100H71,1[10C24%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H72,0-1[8C25%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[34m#Set counter to 0, channel to 1[0m[30;100H[K[30;100H73,1[10C26%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hchan = [31m0[0m [34m#No need to iterate here[0m[30;100H[K[30;100H74,1[10C26%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hi = [31m0[0m[30;100H[K[30;100H75,1[10C27%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[34m#Clean each image and store it in output[0m[30;100H[K[30;100H76,1[10C27%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[33mfor[0m i [33min[0m [36mrange[0m(X.shape[[31m0[0m]):[30;100H[K[30;100H77,1[10C28%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;17H[33mfor[0m j [33min[0m [36mrange[0m(n_angles):[30;100H[K[30;100H78,1[10C28%[29;1H[34h[?25h[?25l[1;29r[1;1H[2M[1;30r[28;21HX_train[i,j,:,:,chan] = hfuncs.CropCleanResize(X[i,:,:,j],FINAL_WIDTH,FINAL_HEIGHT)[29;21Hy_train[i,:] = y[i,:][30;100H[K[30;100H79,1[10C29%[28;1H[34h[?25h[?25l[30;100H80[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H81,1[10C30%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;17H[33myield[0m X_train[i,:,:,:,:],y_train[i][30;100H[K[30;100H82,1[10C30%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H83,1[10C31%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[33mdef[0m [36mCleanKeyAry[0m(key_ary,labels_dict,dataDir,extension):[30;100H[K[30;100H84,1[10C31%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[31m'''Taken from the BatchRequester class'''[0m[30;100H[K[30;100H85,1[10C32%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey_ary_new=[][30;100H[K[30;100H86,1[10C33%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[33mfor[0m key [33min[0m key_ary:[30;100H[K[30;100H87,1[10C33%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9Himg_id = key.strip().replace(dataDir,[31m''[0m).replace(extension,[31m''[0m)[30;100H[K[30;100H88,1[10C34%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[33mif[0m img_id [33min[0m labels_dict.keys():[30;100H[K[30;100H89,1[10C34%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hkey_ary_new.append(key)[30;100H[K[30;100H90,1[10C35%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9H[33melse[0m:[30;100H[K[30;100H91,1[10C36%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;13H[33mcontinue[0m[30;100H[K[30;100H92,1[10C36%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[33mreturn[0m key_ary_new[30;100H[K[30;100H93,1[10C37%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H94,0-1[8C37%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[33mdef[0m [36mgetTrainTestValData[0m(labels_dir=LABELS_DIR,extension=EXTENSION,dataDir=DATA_DIR,bucketName=BUCKET_NAME):[30;100H[K[30;100H95,1[10C38%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[31m'''Retrieves all samples that have corresponding labels [0m[30;100H[K[30;100H96,1[10C38%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[31m    and splits data into a train, test, val set. '''[0m[30;100H[K[30;100H97,1[10C39%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#Labels        [0m[30;100H[K[30;100H98,1[10C40%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hlabels_dict = hfuncs.GetLabelsDict(labels_dir)[30;100H[K[30;100H99,1[10C40%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H100,1[9C41%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#AWS Bucket[0m[30;100H[K[30;100H101,1[9C41%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey_id, secret_key = hfuncs.GetAWSCredentials()[30;100H[K[30;100H102,1[9C42%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hclient = hfuncs.GetAWSClient(key_id,secret_key)[30;100H[K[30;100H103,1[9C43%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hbucket = client.Bucket(bucketName)[30;100H[K[30;100H104,1[9C43%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H105,1[9C44%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[34m#Get shuffled keys and separate into train,test,and validation[0m[30;100H[K[30;100H106,1[9C44%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey_ary = hfuncs.GetShuffledKeys(bucket)[30;100H[K[30;100H107,1[9C45%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey_ary = CleanKeyAry(key_ary,labels_dict,dataDir,extension)[30;100H[K[30;100H108,1[9C45%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5HK_train,K_test = train_test_split(key_ary,test_size=[31m0.20[0m,random_state=[31m0[0m)[30;100H[K[30;100H109,1[9C46%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5HK_train,K_val = train_test_split(K_train,test_size=[31m0.25[0m,random_state=[31m0[0m) [34m#0.80*0.25 = 0.20 validation [0m[30;100H[K[30;100H110,1[9C47%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H111,1[9C47%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[33mreturn[0m K_train,K_test,K_val[30;100H[K[30;100H112,1[9C48%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Load train, test, and val sets[0m[30;100H[K[30;100H113,1[9C48%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H114,0-1[7C49%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Load data from pickled file[0m[30;100H[K[30;100H115,1[9C50%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[33mwith[0m [36mopen[0m([31m"data_separated.pickle"[0m,[31m"rb"[0m) [33mas[0m f:[30;100H[K[30;100H116,1[9C50%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hsave = pickle.load(f)[30;100H[K[30;100H117,1[9C51%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5HK_train = save[[31m'K_train'[0m][30;100H[K[30;100H118,1[9C51%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5HK_val = save[[31m'K_val'[0m][30;100H[K[30;100H119,1[9C52%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5HK_test = save[[31m'K_test'[0m][30;100H[K[30;100H120,1[9C52%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H121,0-1[7C53%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Last time accidentatlly put K_train into key K_test.[0m[30;100H[K[30;100H122,1[9C54%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Now we must manually create K_test    [0m[30;100H[K[30;100H123,1[9C54%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#key_id, secret_key = hfuncs.GetAWSCredentials()[0m[30;100H[K[30;100H124,1[9C55%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#client = hfuncs.GetAWSClient(key_id,secret_key)[0m[30;100H[K[30;100H125,1[9C55%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#bucket = client.Bucket(BUCKET_NAME) [0m[30;100H[K[30;100H126,1[9C56%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H127,0-1[7C56%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Get all keys and create set of those neither in K_train nor K_val[0m[30;100H[K[30;100H128,1[9C57%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#labels_dir = LABELS_DIR[0m[30;100H[K[30;100H129,1[9C58%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#labels_dict = hfuncs.GetLabelsDict(labels_dir)[0m[30;100H[K[30;100H130,1[9C58%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#dataDir = DATA_DIR[0m[30;100H[K[30;100H131,1[9C59%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#extension = EXTENSION[0m[30;100H[K[30;100H132,1[9C59%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#key_ary = hfuncs.GetShuffledKeys(bucket) [0m[30;100H[K[30;100H133,1[9C60%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#print("Got all keys")[0m[30;100H[K[30;100H134,1[9C61%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#key_ary = CleanKeyAry(key_ary,labels_dict,dataDir,extension)[0m[30;100H[K[30;100H135,1[9C61%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#print("Cleaned keys")[0m[30;100H[K[30;100H136,1[9C62%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#print("Creating test set again..")[0m[30;100H[K[30;100H137,1[9C62%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#K_test = [k for k in key_ary if ((k not in K_train) and (k not in K_val))][0m[30;100H[K[30;100H138,1[9C63%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H139,0-1[7C63%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Save data split again[0m[30;100H[K[30;100H140,1[9C64%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#save = {'K_train':K_train,'K_test':K_test,'K_val':K_val}[0m[30;100H[K[30;100H141,1[9C65%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H142,0-1[7C65%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#with open("data_separated.pickle","wb") as f:[0m[30;100H[K[30;100H143,1[9C66%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#    pickle.dump(save,f)[0m[30;100H[K[30;100H144,1[9C66%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H145,0-1[7C67%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Connect to aws s3[0m[30;100H[K[30;100H146,1[9C68%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1HUPLOAD_BUCKET = [31m'cleandhsdata'[0m[30;100H[K[30;100H147,1[9C68%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hkey_id, secret_key = hfuncs.GetAWSCredentials()[30;100H[K[30;100H148,1[9C69%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hclient = hfuncs.GetAWSClient(key_id,secret_key)[30;100H[K[30;100H149,1[9C69%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hbucket = client.Bucket(UPLOAD_BUCKET)[30;100H[K[30;100H150,1[9C70%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H151,0-1[7C70%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Clean and upload[0m[30;100H[K[30;100H152,1[9C71%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hlogging.info([31m"Starting train upload"[0m)[30;100H[K[30;100H153,1[9C72%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hkey_root = [31m"train_scan"[0m[30;100H[K[30;100H154,1[9C72%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1HtrainGen = myScanGenerator(K_train,[31m5[0m)[30;100H[K[30;100H155,1[9C73%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hi = [31m0[0m[30;100H[K[30;100H156,1[9C73%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[33mfor[0m X, y [33min[0m trainGen.GenerateSamples():[30;100H[K[30;100H157,1[9C74%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hfilename = os.path.join(TEMP_DIR,[31m"batch_{}.hdf5"[0m.format(i))[30;100H[K[30;100H158,1[9C75%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey = [31m"{}/{}"[0m.format(key_root,[31m"batch_{}.hdf5"[0m.format(i))[30;100H[K[30;100H159,1[9C75%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[33mwith[0m h5py.File(filename,[31m"w"[0m) [33mas[0m f:[30;100H[K[30;100H160,1[9C76%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9Hdset = f.create_dataset([31m'image'[0m,data=X)[30;100H[K[30;100H161,1[9C76%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9Hdset2 = f.create_dataset([31m'labels'[0m,data=y)[30;100H[K[30;100H162,1[9C77%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hbucket.upload_file(Filename=filename,Key=key)[30;100H[K[30;100H163,1[9C77%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hos.remove(filename)[30;100H[K[30;100H164,1[9C78%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hi += [31m1[0m[30;100H[K[30;100H165,1[9C79%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hlogging.info([31m"Completed batch {}"[0m.format(i))[30;100H[K[30;100H166,1[9C79%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[36mprint[0m([31m"Completed batch {}"[0m.format(i))[30;100H[K[30;100H167,1[9C80%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H168,0-1[7C80%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Clean and upload[0m[30;100H[K[30;100H169,1[9C81%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hlogging.info([31m"Starting val upload"[0m)[30;100H[K[30;100H170,1[9C81%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hkey_root = [31m"val_scan"[0m[30;100H[K[30;100H171,1[9C82%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1HtrainGen = myScanGenerator(K_val,[31m5[0m)[30;100H[K[30;100H172,1[9C83%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1Hi = [31m0[0m[30;100H[K[30;100H173,1[9C83%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[33mfor[0m X, y [33min[0m trainGen.GenerateSamples():[30;100H[K[30;100H174,1[9C84%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hfilename = os.path.join(TEMP_DIR,[31m"batch_{}.hdf5"[0m.format(i))[30;100H[K[30;100H175,1[9C84%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hkey = [31m"{}/{}"[0m.format(key_root,[31m"batch_{}.hdf5"[0m.format(i))[30;100H[K[30;100H176,1[9C85%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[33mwith[0m h5py.File(filename,[31m"w"[0m) [33mas[0m f:[30;100H[K[30;100H177,1[9C86%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9Hdset = f.create_dataset([31m'image'[0m,data=X)[30;100H[K[30;100H178,1[9C86%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;9Hdset2 = f.create_dataset([31m'labels'[0m,data=y)[30;100H[K[30;100H179,1[9C87%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hbucket.upload_file(Filename=filename,Key=key)[30;100H[K[30;100H180,1[9C87%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hos.remove(filename)[30;100H[K[30;100H181,1[9C88%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hi += [31m1[0m[30;100H[K[30;100H182,1[9C88%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5Hlogging.info([31m"Completed batch {}"[0m.format(i))[30;100H[K[30;100H183,1[9C89%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;5H[36mprint[0m([31m"Completed batch {}"[0m.format(i))[30;100H[K[30;100H184,1[9C90%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[30;100H[K[30;100H185,1[9C90%[29;1H[34h[?25h[?25l[1;29r[29;1H
[1;30r[29;1H[34m#Clean and upload[0m[30;100H[K[30;100H186,1[9C91%[29;1H[34h[?25h[?25l[30;100H[K[30;1H:[34h[?25hq[?25l[34h[?25h[?25l[30;1H[K[30;1H[?1l>[34h[?25h[?1049l(DHSenv_3.5) ubuntu@ip-172-31-27-171:~/machine-learning/projects/capstone/DHSThreatRecognition$ scr[K[K[K